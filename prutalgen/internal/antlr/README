the code is forked from github.com/antlr/antlr4/pull/4754
